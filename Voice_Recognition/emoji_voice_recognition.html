<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Emoji ç»ƒå£è¯­</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Font Awesome Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Confetti Animation -->
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.5.1/dist/confetti.browser.min.js"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    animation: {
                        'bounce-slow': 'bounce 3s infinite',
                        'pulse-slow': 'pulse 3s infinite',
                        'wiggle': 'wiggle 1s ease-in-out infinite',
                        'zoom-in': 'zoomIn 0.5s ease-out forwards'
                    },
                    keyframes: {
                        wiggle: {
                            '0%, 100%': { transform: 'rotate(-3deg)' },
                            '50%': { transform: 'rotate(3deg)' },
                        },
                        zoomIn: {
                            '0%': { transform: 'scale(0.5)', opacity: '0.5' },
                            '70%': { transform: 'scale(1.1)' },
                            '100%': { transform: 'scale(1)', opacity: '1' }
                        }
                    }
                }
            }
        }
    </script>
    <style>
        /* è‡ªå®šä¹‰æ ·å¼è¡¥å…… */
        @keyframes float {
            0% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
            100% { transform: translateY(0px); }
        }
        .float-animation {
            animation: float 3s ease-in-out infinite;
        }
        .gradient-border:focus {
            border-image: linear-gradient(to right, #8a56ff, #61dafb) 1;
        }
    </style>
</head>
<body class="bg-gradient-to-br from-indigo-50 via-purple-50 to-blue-50 min-h-screen">
    <!-- èƒŒæ™¯è£…é¥° -->
    <div class="fixed top-0 left-0 w-64 h-64 bg-yellow-100 rounded-full -translate-x-1/2 -translate-y-1/2 opacity-70"></div>
    <div class="fixed bottom-0 right-0 w-96 h-96 bg-blue-100 rounded-full translate-x-1/3 translate-y-1/3 opacity-70"></div>

    <!-- ä¸»å®¹å™¨ -->
    <div class="container mx-auto px-4 py-8 flex items-center justify-center min-h-screen relative z-10">
        <div class="bg-white rounded-2xl shadow-lg p-6 md:p-8 w-full max-w-md transition-all duration-300 hover:shadow-xl relative overflow-hidden">
            <!-- å…³é—­æŒ‰é’® -->
            <button id="closeButton" class="absolute top-4 right-4 text-gray-400 hover:text-gray-600 transition-colors">
                <i class="fas fa-times text-xl"></i>
            </button>

            <!-- æ ‡é¢˜ -->
            <h1 class="text-3xl font-bold text-center text-indigo-500 mb-6" style="font-family: 'PingFang SC', sans-serif;">Emoji ç»ƒå£è¯­</h1>

            <!-- è¯´æ˜æ–‡å­— -->
            <div class="text-gray-600 text-sm mb-6 space-y-2">
                <p class="flex items-start">
                    <i class="fas fa-info-circle text-blue-400 mr-2 mt-1"></i>
                    <span style="font-family: 'PingFang SC', sans-serif;">ç‚¹å‡»ä¸‹æ–¹ã€Œå¼€å§‹è¯­éŸ³è¯†åˆ«ã€æŒ‰é’®ï¼Œè¯´å‡ºé£Ÿç‰©ã€æ°´æœã€åŠ¨ç‰©ã€äº¤é€šå·¥å…·æˆ–è¡¨æƒ…çš„ Emoji è‹±æ–‡åç§°ï¼Œçœ‹çœ‹ä½ èƒ½ç­”å¯¹å‡ ä¸ªï¼</span>
                </p>
                <p class="flex items-start">
                    <i class="fas fa-info-circle text-blue-400 mr-2 mt-1"></i>
                    <span style="font-family: 'PingFang SC', sans-serif;">å¯ä»¥å…ˆè¯•è¯•ä»¥ä¸‹ä¾‹å­ï¼š</span>
                </p>
            </div>

            <!-- ç¤ºä¾‹ Emoji -->
            <div id="exampleEmojis" class="flex justify-center items-center p-10 bg-gray-50 rounded-xl mb-12 shadow-md gap-4">
                <!-- ç¤ºä¾‹å°†ç”±JavaScriptåŠ¨æ€ç”Ÿæˆ -->
            </div>

            <!-- è¯­éŸ³è¯†åˆ«æŒ‰é’® -->
            <button id="speechButton" class="w-3/5 mx-auto py-4 bg-indigo-500 text-white rounded-full font-bold flex items-center justify-center space-x-2 transition-all duration-300 hover:bg-indigo-600 hover:scale-105 focus:outline-none focus:ring-2 focus:ring-indigo-300 focus:ring-opacity-50 shadow-md">
                <i class="fas fa-microphone"></i>
                <span style="font-family: 'PingFang SC', sans-serif;">å¼€å§‹è¯­éŸ³è¯†åˆ«</span>
            </button>

            <!-- è¯†åˆ«ç»“æœ -->
            <div id="result" class="mt-6 p-4 bg-gray-50 rounded-xl text-gray-600 min-h-[60px] text-center shadow-md">
                <span style="font-family: 'PingFang SC', sans-serif;">å‡†å¤‡å¥½äº†å—ï¼Ÿç‚¹å‡»ä¸Šæ–¹æŒ‰é’®å¼€å§‹è¯†åˆ«...</span>
            </div>

            <!-- Emoji æ˜¾ç¤ºåŒºåŸŸ -->
            <div id="emojiDisplay" class="hidden text-8xl text-center my-6 transform transition-all duration-500 shadow-md rounded-xl p-4"></div>

            <!-- ç§¯åˆ†åŒºåŸŸ -->
            <div class="flex items-center justify-between mt-6 p-4 bg-gray-50 rounded-xl shadow-md">
                <div class="flex items-center space-x-2 px-4 py-2 rounded-lg">
                    <i class="fas fa-star text-yellow-400"></i>
                    <span class="font-bold text-indigo-500" style="font-family: 'PingFang SC', sans-serif;">æœ¬è½®ç§¯åˆ†: <span id="scoreValue" class="font-bold">0</span></span>
                </div>
                <button id="resetScore" class="px-4 py-2 bg-red-400 text-white rounded-full font-bold transition-all hover:bg-red-500 hover:scale-105 focus:outline-none focus:ring-2 focus:ring-red-300 shadow-sm">
                    <i class="fas fa-redo-alt mr-1"></i><span style="font-family: 'PingFang SC', sans-serif;">é‡ç½®ç§¯åˆ†</span>
                </button>
            </div>

            <!-- æµè§ˆå™¨æ”¯æŒä¿¡æ¯ -->
            <div class="text-center text-gray-400 text-xs mt-6 flex items-center justify-center">
                <i class="fas fa-info-circle mr-1"></i>
                <span style="font-family: 'PingFang SC', sans-serif;">æ”¯æŒçš„æµè§ˆå™¨ï¼šChromeã€Edgeã€Safari</span>
            </div>
        </div>
    </div>

    <script>
        // Emoji æ˜ å°„è¡¨ - åŒ…å«ä¸­è‹±æ–‡å…³é”®è¯å’Œå¯¹åº”çš„Emoji
        const emojiMap = {
            // é£Ÿç‰©ç±»
            "è›‹ç³•": "ğŸ°",
            "cake": "ğŸ°",
            "ç”œç”œåœˆ": "ğŸ©",
            "donut": "ğŸ©",
            "æŠ«è¨": "ğŸ•",
            "pizza": "ğŸ•",
            "æ±‰å ¡": "ğŸ”",
            "hamburger": "ğŸ”",
            "è–¯æ¡": "ğŸŸ",
            "fries": "ğŸŸ",
            "çƒ­ç‹—": "ğŸŒ­",
            "hotdog": "ğŸŒ­",
            "ä¸‰æ˜æ²»": "ğŸ¥ª",
            "sandwich": "ğŸ¥ª",
            "å†°æ·‡æ·‹": "ğŸ¦",
            "ice cream": "ğŸ¦",
            "å·§å…‹åŠ›": "ğŸ«",
            "chocolate": "ğŸ«",
            "çˆ†ç±³èŠ±": "ğŸ¿",
            "popcorn": "ğŸ¿",
            // æ°´æœç±»
            "è‹¹æœ": "ğŸ",
            "apple": "ğŸ",
            "é¦™è•‰": "ğŸŒ",
            "banana": "ğŸŒ",
            "è‰è“": "ğŸ“",
            "strawberry": "ğŸ“",
            "è¥¿ç“œ": "ğŸ‰",
            "watermelon": "ğŸ‰",
            "è‘¡è„": "ğŸ‡",
            "grape": "ğŸ‡",
            "è è": "ğŸ",
            "pineapple": "ğŸ",
            // åŠ¨ç‰©ç±»
            "çŒ«": "ğŸ±",
            "cat": "ğŸ±",
            "ç‹—": "ğŸ¶",
            "dog": "ğŸ¶",
            "è€è™": "ğŸ¯",
            "tiger": "ğŸ¯",
            "ç†ŠçŒ«": "ğŸ¼",
            "panda": "ğŸ¼",
            "çŒ´å­": "ğŸµ",
            "monkey": "ğŸµ",
            "å…”å­": "ğŸ°",
            "rabbit": "ğŸ°",
            // äº¤é€šå·¥å…·
            "æ±½è½¦": "ğŸš—",
            "car": "ğŸš—",
            "å…¬äº¤è½¦": "ğŸšŒ",
            "bus": "ğŸšŒ",
            "ç«è½¦": "ğŸš‚",
            "train": "ğŸš‚",
            "é£æœº": "âœˆï¸",
            "airplane": "âœˆï¸",
            "è‡ªè¡Œè½¦": "ğŸš²",
            "bicycle": "ğŸš²",
            // è¡¨æƒ…
            "ç¬‘è„¸": "ğŸ˜Š",
            "smile": "ğŸ˜Š",
            "å“­æ³£": "ğŸ˜¢",
            "cry": "ğŸ˜¢",
            "ç”Ÿæ°”": "ğŸ˜ ",
            "angry": "ğŸ˜ ",
            "æƒŠè®¶": "ğŸ˜²",
            "surprised": "ğŸ˜²"
        };

        // DOM å…ƒç´ 
        const speechButton = document.getElementById('speechButton');
        const resultDiv = document.getElementById('result');
        const emojiDisplay = document.getElementById('emojiDisplay');
        const exampleEmojisDiv = document.getElementById('exampleEmojis');
        const closeButton = document.getElementById('closeButton');
        
        // å…¨å±€å˜é‡
        let silenceTimer, recognitionTimeout;
        let isSoundStarted = false;
        let isRecognitionInitialized = false; // è·Ÿè¸ªè¯­éŸ³è¯†åˆ«æ˜¯å¦å·²åˆå§‹åŒ–
        let recognition;
        let score = 0; // ç§¯åˆ†ç³»ç»Ÿ
        let recognizedWords = new Set(); // å­˜å‚¨å·²è¯†åˆ«çš„è¯æ±‡

        // ä»emojiMapä¸­éšæœºé€‰æ‹©ä¸‰ä¸ªEmojiä½œä¸ºä¾‹å­
        function showRandomEmojiExamples() {
            // æ¸…ç©ºç°æœ‰çš„ä¾‹å­
            exampleEmojisDiv.innerHTML = '';
            
            // è·å–æ‰€æœ‰emojiMapçš„é”®å€¼å¯¹å¹¶è½¬æ¢ä¸ºæ•°ç»„
            const emojiEntries = Object.entries(emojiMap);
            // è¿‡æ»¤æ‰é‡å¤çš„Emojiï¼ˆä¸­è‹±æ–‡å¯¹åº”åŒä¸€ä¸ªEmojiï¼‰
            const uniqueEmojis = [];
            const usedEmojis = new Set();
            
            for (const [keyword, emoji] of emojiEntries) {
                if (!usedEmojis.has(emoji)) {
                    uniqueEmojis.push({keyword, emoji});
                    usedEmojis.add(emoji);
                }
            }
            
            // éšæœºæ‰“ä¹±æ•°ç»„
            const shuffled = [...uniqueEmojis].sort(() => 0.5 - Math.random());
            
            // å–å‰ä¸‰ä¸ªä½œä¸ºä¾‹å­
            const examples = shuffled.slice(0, 3);
            
            // åˆ›å»ºå¹¶æ·»åŠ åˆ°DOM
            examples.forEach(({keyword, emoji}) => {
                const exampleDiv = document.createElement('div');
                exampleDiv.className = 'flex flex-col items-center float-animation mx-2';
                
                const emojiSpan = document.createElement('span');
                emojiSpan.className = 'text-5xl mb-3 shadow-lg p-3 rounded-full bg-gradient-to-r from-pink-100 to-yellow-100 hover:from-yellow-100 hover:to-pink-100 transition-all duration-300 transform hover:scale-110';
                emojiSpan.textContent = emoji;
                
                const nameSpan = document.createElement('span');
                nameSpan.className = 'text-xs text-teal-600 bg-white px-3 py-1 rounded-full shadow-md border border-teal-100 font-bold';
                
                // ç¡®ä¿æ˜¾ç¤ºè‹±æ–‡åç§°
                // å¦‚æœå½“å‰å…³é”®è¯æ˜¯ä¸­æ–‡ï¼Œåˆ™æŸ¥æ‰¾å¯¹åº”çš„è‹±æ–‡
                if (/[\u4e00-\u9fa5]/.test(keyword)) {
                    // æŸ¥æ‰¾ç›¸åŒemojiçš„è‹±æ–‡åç§°
                    for (const [key, value] of Object.entries(emojiMap)) {
                        if (value === emoji && !/[\u4e00-\u9fa5]/.test(key)) {
                            nameSpan.textContent = key;
                            break;
                        }
                    }
                } else {
                    // å¦‚æœå·²ç»æ˜¯è‹±æ–‡ï¼Œç›´æ¥ä½¿ç”¨
                    nameSpan.textContent = keyword;
                }
                
                exampleDiv.appendChild(emojiSpan);
                exampleDiv.appendChild(nameSpan);
                exampleEmojisDiv.appendChild(exampleDiv);
            });
        }

        function initRecognition() {
            // å¦‚æœè¯­éŸ³è¯†åˆ«å·²åˆå§‹åŒ–ï¼Œåªéœ€é‡ç½®äº‹ä»¶ç›‘å¬å™¨
            if (isRecognitionInitialized && recognition) {
                recognition.stop();
                clearTimeout(silenceTimer);
                clearTimeout(recognitionTimeout);
                return;
            }
            
            // æ¸…ç†æ®‹ç•™çš„è¯†åˆ«å®ä¾‹
            if (recognition) {
                recognition.stop();
                recognition.onresult = null;
                recognition.onerror = null;
                recognition.onsoundstart = null;
                recognition.onsoundend = null;
                recognition.onend = null;
            }
            
            clearTimeout(silenceTimer);
            clearTimeout(recognitionTimeout);

            // åˆ›å»ºæ–°å®ä¾‹
            recognition = new (window.SpeechRecognition || window.webkitSpeechRecognition)();
            recognition.lang = 'zh-CN'; // è®¾ç½®ä¸ºä¸­æ–‡è¯†åˆ«
            recognition.interimResults = false;
            recognition.maxAlternatives = 1;
            recognition.continuous = false;

            // ç§»åŠ¨è®¾å¤‡ä¼˜åŒ–
            if (/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)) {
                recognition.interimResults = true; // åœ¨ç§»åŠ¨è®¾å¤‡ä¸Šå¯ç”¨ä¸­é—´ç»“æœ
                recognition.continuous = true; // åœ¨ç§»åŠ¨è®¾å¤‡ä¸Šå¯ç”¨è¿ç»­è¯†åˆ«
            }

            // äº‹ä»¶ç›‘å¬
            recognition.onsoundstart = () => {
                isSoundStarted = true;
                clearTimeout(silenceTimer);
                resultDiv.innerHTML = "<span style=\"font-family: 'PingFang SC', sans-serif;\">æ­£åœ¨è†å¬...</span>";
                resultDiv.className = "mt-6 p-4 bg-blue-50 rounded-xl text-teal-600 min-h-[60px] text-center border-2 border-blue-100";
            };

            recognition.onsoundend = () => {
                if (isSoundStarted) {
                    silenceTimer = setTimeout(() => {
                        recognition.stop();
                        resultDiv.innerHTML = "<span style=\"font-family: 'PingFang SC', sans-serif;\">15ç§’å†…æœªæ£€æµ‹åˆ°å£°éŸ³ï¼Œè¯†åˆ«å·²åœæ­¢ã€‚</span>";
                        resultDiv.className = "mt-6 p-4 bg-blue-50 rounded-xl text-teal-600 min-h-[60px] text-center border-2 border-blue-100";
                    }, 15000);
                }
            };

            recognition.onresult = (event) => {
                clearAllTimers();
                const speechResult = event.results[0][0].transcript.toLowerCase();
                
                isRecognitionInitialized = true; // æ ‡è®°è¯­éŸ³è¯†åˆ«å·²åˆå§‹åŒ–
                
                // æŸ¥æ‰¾åŒ¹é…çš„å…³é”®è¯
                let foundMatch = false;
                let matchedKeyword = '';
                let matchedEmoji = '';
                
                // éå†emojiMapæŸ¥æ‰¾åŒ¹é…é¡¹
                for (const [keyword, emoji] of Object.entries(emojiMap)) {
                    if (speechResult.includes(keyword.toLowerCase())) {
                        foundMatch = true;
                        matchedKeyword = keyword;
                        matchedEmoji = emoji;
                        break;
                    }
                }
                
                if (foundMatch) {
                    emojiDisplay.textContent = matchedEmoji;
                    emojiDisplay.classList.remove('hidden');
                    emojiDisplay.classList.add('animate-zoom-in');
                    
                    // æ£€æŸ¥æ˜¯å¦å·²ç»è¯†åˆ«è¿‡
                    if (recognizedWords.has(matchedKeyword.toLowerCase())) {
                        resultDiv.innerHTML = `<span style="font-family: 'PingFang SC', sans-serif;">${matchedKeyword} å·²ç»è¯†åˆ«è¿‡äº†å“¦</span>`;
                        resultDiv.className = "mt-6 p-4 bg-yellow-100 rounded-xl text-orange-600 min-h-[60px] text-center border-2 border-yellow-200";
                    } else {
                        recognizedWords.add(matchedKeyword.toLowerCase());
                        resultDiv.innerHTML = `<span style="font-family: 'PingFang SC', sans-serif;">æ­å–œï¼æ­£ç¡®è¯†åˆ«å‡º Emoji: ${matchedKeyword}</span>`;
                        resultDiv.className = "mt-6 p-4 bg-teal-50 rounded-xl text-teal-600 min-h-[60px] text-center border-2 border-teal-100";
                        
                        // å¢åŠ ç§¯åˆ†
                        score++;
                        document.getElementById('scoreValue').textContent = score;
                        
                        // æ’­æ”¾å½©å¸¦åŠ¨ç”»
                        confetti({
                            particleCount: 100,
                            spread: 70,
                            origin: { y: 0.6 }
                        });
                    }
                } else {
                    emojiDisplay.classList.add('hidden');
                    resultDiv.innerHTML = `<span style="font-family: 'PingFang SC', sans-serif;">æœªè¯†åˆ«å‡º Emoji: ${speechResult}</span>`;
                    resultDiv.className = "mt-6 p-4 bg-pink-50 rounded-xl text-pink-600 min-h-[60px] text-center border-2 border-pink-100";
                    
                    // æ˜¾ç¤ºé¼“åŠ±ä¿¡æ¯
                    setTimeout(() => {
                        resultDiv.innerHTML += `<br><span style="font-family: 'PingFang SC', sans-serif;">å†è¯•ä¸€æ¬¡ï¼Œä½ å¯ä»¥çš„ï¼</span>`;
                    }, 500);
                }
                resetButton();
            };

            recognition.onerror = (event) => {
                clearAllTimers();
                resultDiv.innerHTML = "<span style=\"font-family: 'PingFang SC', sans-serif;\">æœªè¯†åˆ«åˆ°è¯­éŸ³ï¼Œè¯·å†è¯•ä¸€æ¬¡</span>";
                resultDiv.className = "mt-6 p-4 bg-pink-50 rounded-xl text-pink-600 min-h-[60px] text-center border-2 border-pink-100";
                resetButton();
            };

            recognition.onend = () => {
                clearAllTimers();
                if (speechButton.textContent === 'æ­£åœ¨è†å¬...') {
                    resetButton();
                }
            };
        }

        // æ·»åŠ å…³é—­æŒ‰é’®åŠŸèƒ½
        closeButton.addEventListener('click', function() {
            if (confirm('ç¡®å®šè¦å…³é—­æ­¤åº”ç”¨ç¨‹åºå—ï¼Ÿ')) {
                window.close();
            }
        });

        function clearAllTimers() {
            clearTimeout(silenceTimer);
            clearTimeout(recognitionTimeout);
            isSoundStarted = false;
        }

        function resetButton() {
            speechButton.disabled = false;
            speechButton.innerHTML = '<i class="fas fa-microphone"></i><span>å¼€å§‹è¯­éŸ³è¯†åˆ«</span>';
            speechButton.classList.remove('bg-gray-400');
            speechButton.classList.add('bg-indigo-500', 'hover:bg-indigo-600');
        }

        // é¡µé¢åŠ è½½æ—¶æ˜¾ç¤ºéšæœºEmojiä¾‹å­å¹¶é¢„åˆå§‹åŒ–è¯­éŸ³è¯†åˆ«
        document.addEventListener('DOMContentLoaded', function() {
            showRandomEmojiExamples();
            
            // æ£€æŸ¥æµè§ˆå™¨å…¼å®¹æ€§å¹¶é¢„åˆå§‹åŒ–è¯­éŸ³è¯†åˆ«
            if ('SpeechRecognition' in window || 'webkitSpeechRecognition' in window) {
                // é¢„åˆå§‹åŒ–è¯­éŸ³è¯†åˆ«å¯¹è±¡ï¼Œè¿™æ ·éº¦å…‹é£æƒé™åªä¼šåœ¨é¦–æ¬¡åŠ è½½æ—¶è¯·æ±‚ä¸€æ¬¡
                initRecognition();
                isRecognitionInitialized = true;
            }
            
            // æ·»åŠ é‡ç½®ç§¯åˆ†æŒ‰é’®çš„äº‹ä»¶ç›‘å¬å™¨
            document.getElementById('resetScore').addEventListener('click', function() {
                score = 0;
                document.getElementById('scoreValue').textContent = score;
                recognizedWords.clear(); // æ¸…ç©ºå·²è¯†åˆ«çš„è¯æ±‡
                resultDiv.innerHTML = "<span style=\"font-family: 'PingFang SC', sans-serif;\">ç§¯åˆ†å·²é‡ç½®ï¼Œè¯·ç»§ç»­æ¸¸æˆï¼</span>";
                resultDiv.className = "mt-6 p-4 bg-blue-50 rounded-xl text-teal-600 min-h-[60px] text-center border-2 border-blue-100";
                emojiDisplay.classList.add('hidden');
            });
        });

        // æ·»åŠ è§¦æ‘¸äº‹ä»¶æ”¯æŒ
        function handleSpeechButtonEvent(event) {
            event.preventDefault(); // é˜²æ­¢åŒå‡»ç¼©æ”¾

            // æ£€æŸ¥æ˜¯å¦ä¸ºè§¦æ‘¸äº‹ä»¶ç»“æŸ
            if (event.type === 'touchend' && event.cancelable) {
                return;
            }

            // æ£€æŸ¥æµè§ˆå™¨å…¼å®¹æ€§
            if (!('SpeechRecognition' in window || 'webkitSpeechRecognition' in window)) {
                resultDiv.innerHTML = '<span style="font-family: \'PingFang SC\', sans-serif;">æŠ±æ­‰ï¼Œæ‚¨çš„æµè§ˆå™¨ä¸æ”¯æŒè¯­éŸ³è¯†åˆ«ã€‚è¯·å°è¯•ä½¿ç”¨Chromeã€Edgeæˆ–Safariã€‚</span>';
                resultDiv.className = "mt-6 p-4 bg-pink-50 rounded-xl text-pink-600 min-h-[60px] text-center border-2 border-pink-100";
                return;
            }

            // æ›´æ–°éšæœºEmojiä¾‹å­
            showRandomEmojiExamples();

            speechButton.disabled = true;
            speechButton.innerHTML = '<i class="fas fa-spinner fa-spin"></i><span>æ­£åœ¨è†å¬...</span>';
            speechButton.classList.remove('bg-indigo-500', 'hover:bg-indigo-600');
            speechButton.classList.add('bg-gray-400');
            emojiDisplay.classList.add('hidden');
            resultDiv.innerHTML = '<span style="font-family: \'PingFang SC\', sans-serif;">è¯·è¯´è¯...</span>';
            resultDiv.className = "mt-6 p-4 bg-gray-50 rounded-xl text-gray-600 min-h-[60px] text-center";

            // å¦‚æœå·²åˆå§‹åŒ–ï¼Œåªéœ€å¯åŠ¨è¯†åˆ«
            if (isRecognitionInitialized) {
                recognition.start();
            } else {
                // é¦–æ¬¡åˆå§‹åŒ–
                initRecognition();
                recognition.start();
                isRecognitionInitialized = true;
            }

            // è®¾ç½®è¶…æ—¶æ£€æµ‹
            recognitionTimeout = setTimeout(() => {
                if (!isSoundStarted) {
                    recognition.stop();
                    resultDiv.innerHTML = '<span style="font-family: \'PingFang SC\', sans-serif;">æœªæ£€æµ‹åˆ°å£°éŸ³ï¼Œè¯·é‡è¯•ã€‚</span>';
                    resultDiv.className = "mt-6 p-4 bg-pink-50 rounded-xl text-pink-600 min-h-[60px] text-center border-2 border-pink-100";
                    resetButton();
                }
            }, 10000);
        }

        // åŒæ—¶æ”¯æŒç‚¹å‡»å’Œè§¦æ‘¸äº‹ä»¶
        speechButton.addEventListener('click', handleSpeechButtonEvent);
        speechButton.addEventListener('touchstart', handleSpeechButtonEvent);
        speechButton.addEventListener('touchend', function(event) {
            event.preventDefault();
        });
    </script>
</body>
</html>